参考文献：

- [《Spring Redis实战开发》](https://wqbook.wqxuetang.com/book/3251192)

# §1 基础语法

## §1.1 CLI语法

增删改查：

| 命令                 | 类型  | 语法                                                                                         | 作用                                                                                                                                                                    |
| ------------------ | --- | ------------------------------------------------------------------------------------------ | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `KEYS`             | 查   | `KEYS <KEY_PATTERN>`                                                                       | 按名查询键，允许使用`*`通配符                                                                                                                                                      |
| `EXISTS`           | 查   | `EXISTS <KEY>`                                                                             | 键值对是否存在，返回`0`/`1`布尔值                                                                                                                                                  |
| `RENAME`           | 改   | `RENAME <OLD_KEY> <NEW_KEY>`                                                               | 重命名键值对                                                                                                                                                                |
| `DEL`              | 删   | `DEL <KEY>+`                                                                               | 删除键值对，若不存在则忽略，返回删除的键值对数量                                                                                                                                              |
| `TYPE`             | 查   | `TYPE <KEY>`                                                                               | 返回键值对的值类型，例如`none`/`string`/`set`/`zset`/`hash`                                                                                                                       |
| `SET`              | 增   | `SET <KEY> <VALUE>`                                                                        | 添加键值对                                                                                                                                                                 |
|                    |     | `SET <KEY> <VALUE> [EX <SECONDS>] [PX <MILLISECONDS>] [NX\|XX]`                            | `EX`指定过期的秒数，`PX`指定过期的毫秒数，`NX`只在键不存在时才操作，`XX`只在键存在时才操作。`EX`和`PX`同时存在时，后面的设置会覆盖前面的设置。                                                                                   |
| `MSET`             | 增   | `MSET [<KEY> <VALUE>]+`                                                                    | 整体作为一个原子操作，同时设置多个键值对                                                                                                                                                  |
| `GET`              | 查   | `GET <KEY>`                                                                                | 输出键值对的值。若键不存在则输出`nil`                                                                                                                                                 |
| `MGET`             | 查   | `MGET [<KEY>]+`                                                                            | 以列表形式，输出多个键值对的值                                                                                                                                                       |
| `GETSET`           | 改/查 | `GETSET <KEY> <VALUE>`                                                                     | 更新键值对的值，并返回旧值                                                                                                                                                         |
| `SETRANGE`         | 改   | `SETRANGE <KEY> <OFFSET> <VALUE>`                                                          | 将字符串从`<OFFSET>`位置开始用`<VALUE>`覆写                                                                                                                                       |
| `GETRANGE`         | 查   | `GETRANGE <KEY> <START> <END>`                                                             | 截取子字符串，支持从最后一位开始计数的负数索引                                                                                                                                               |
| `APPEND`           | 改   | `APPEND <KEY> <VALUE>`                                                                     | 在字符串/列表末尾追加元素，返回追加后的总长度。若键不存在则创建                                                                                                                                      |
| `STRLEN`           | 查   | `STRLEN <KEY>`                                                                             | 返回字符串的长度。若键不存在则返回`0`                                                                                                                                                  |
| `INCRBY`           | 改   | `INCRBY <KEY> <DELTA>`                                                                     | 给键值对的值加上增量`<DELTA>`                                                                                                                                                   |
| `DECRBY`           | 改   | `DECRBY <KEY> <DELTA>`                                                                     | 给键值对的值减去增量`<DELTA>`                                                                                                                                                   |
| `SETBIT`           | 改   | `SETBIT <KEY> <OFFSET> <VALUE>`                                                            | 将字符串视为`std::bitset`，进行Bit级别的修改，其中`<VALUE>`只能为`0`/`1`，若`OFFSET`超出了原有长度则自动扩充                                                                                            |
| `GETBIT`           | 查   | `GETBIT <KEY> <OFFSET>`                                                                    | 将字符串视为`std::bitset`，进行Bit级别的查询                                                                                                                                        |
| `LPUSH`/`RPUSH`    | 增   | `LPUSH/RPUSH <KEY> <VALUE>+`                                                               | 整体作为一个原子操作，在列表表头/表尾同时插入多个值                                                                                                                                            |
| `LLEN`             | 查   | `LLEN <KEY>`                                                                               | 返回列表的长度。若键不存在则返回`0`，若值不是列表则饭后错误                                                                                                                                       |
| `LLOP`/`RPOP`      | 删   | `LPOP/RPOP <KEY>`                                                                          | 删除并返回列表表头/表尾的一个元素。若键不存在则返回`nil`                                                                                                                                       |
| `LRANGE`           | 查   | `LRANGE <KEY> <START> <STOP>`                                                              | 返回列表中位于闭区间`[<START>, <STOP>]`的元素，支持负数索引                                                                                                                               |
| `LSET`             | 改   | `LSET <KEY> <INDEX> <VALUE>`                                                               | 将列表中索引为`<INDEX>`的值设置为`<VALUE>`，若键不存在或列表为空时返回错误                                                                                                                        |
| `LTRIM`            | 改   | `LTRIM <KEY> <START> <STOP>`                                                               | 列表只保留位于闭区间`[<START>, <STOP>]`的元素，支持负数索引，若值不是列表则返回错误                                                                                                                   |
| `LMOVE`            | 改   | `LMOVE <SOURCE_KEY> <DESTINATION_KEY> <LEFT\|RIGHT> <LEFT\|RIGHT>`                         | 整体作为一个原子操作，将列表`<SOURCE_KEY>`的表头/表尾第一个元素移动到列表`<DESTINATION_KEY>`的表头/表尾处                                                                                                |
| `LINDEX`           | 查   | `LINDEX <KEY> <INDEX>`                                                                     | 返回列表的第`<INDEX>`个元素，从`0`开始数，支持负数索引。若值不是列表则返回错误                                                                                                                         |
| `LREM`             | 删   | `LREM <KEY> <COUNT> <VALUE>`                                                               | 删除列表中值为`<VALUE>`的元素。`COUNT>0`/`COUNT<0`时表示从前往后/从后往前搜索前`<COUNT>`个匹配项，`COUNT=0`表示删除全部匹配项                                                                                |
| `HSET`             | 增   | `HSET <KEY> <FIELD> <VALUE>`                                                               | 给哈希表`<KEY>`设置键值对`<FIELD>:<VALUE>`。若`<FIELD>`已存在/未存在则返回`0`/`1`，若`<KEY>`不存在则新建哈希表后设置                                                                                    |
| `HGET`             | 查   | `HGET <KEY> <FIELD>`                                                                       | 返回哈希表中的键`<FIELD>`对应的值，若`<FIELD>`不存在则返回`nil`                                                                                                                           |
| `HMSET`            | 增   | `HMSET <KEY> [<FIELD> <VALUE>]+`                                                           | 整体作为一个原子操作，同时在哈希表中设置多个键值对，执行成功返回`OK`，若`<KEY>`不是哈希表则返回错误                                                                                                               |
| `HMGET`            | 查   | `HGET <KEY> <FIELD>+`                                                                      | 返回哈希表中的多个键对应的值列表                                                                                                                                                      |
| `HGETALL`          | 查   | `HGETALL <KEY>`                                                                            | 返回哈希表中的所有键和值，以列表格式给出，具体顺序为`[<FIELD_i> <VALUE_i>]+`                                                                                                                    |
| `HDEL`             | 删   | `HDEL <KEY> <FIELD>+`                                                                      | 删除哈希表中的一个或多个键值对                                                                                                                                                       |
| `HLEN`             | 查   | `HLEN <KEY>`                                                                               | 返回哈希表中的键值对数量                                                                                                                                                          |
| `HEXISTS`          | 查   | `HEXISTS <KEY> <FIELD>`                                                                    | 查询哈希表中是否存在某个键值对，返回`0`/`1`                                                                                                                                             |
| `HKEYS`            | 查   | `HKEYS <KEY>`                                                                              | 返回哈希表中的所有`<FIELD>`，以列表形式给出                                                                                                                                            |
| `HVALS`            | 查   | `HVALS <KEY>`                                                                              | 返回哈希表中的所有`<VALUE>`，以列表形式给出                                                                                                                                            |
| `HSCAN`            | 查   |                                                                                            | TODO：？？？                                                                                                                                                              |
| `HINCRBY`          | 改   | `HINCRBY <KEY> <FIELD> <INCREMENT>`                                                        | 将哈希表中的某个`int64`值添加`<INCREMENT>`的增量。若`<KEY>`不存在则新建哈希表，若`<FIELD>`不存在则设置初始值为`0`                                                                                          |
| `SADD`             | 增   | `SADD <KEY> <MEMBER>+`                                                                     | 将若干个元素`<MEMBER>+`添加到集合中，返回集合原先不存在的元素的数量                                                                                                                               |
| `SMEMBERS`         | 查   | `SMEMBERS`                                                                                 | 返回集合中的所有成员                                                                                                                                                            |
| `SMOVE`            | 改   | `SMOVE <SOURCE> <DESTINATION> <MEMBER>`                                                    | 将集合`<SOURCE>`中的元素`<MEMBER>`移动到集合`<DESTINATION>`中。若`<MEMBER>`在`<SOURCE>`中不存在或`<SOURCE>`不存在则返回`0`；若`<SOURCE>`或`<DESTINATION>`非集合类型则返回错误；若`<MEMBER>`存在于`<SOURCE>`则返回`1`。 |
| `SREM`             | 删   | `SREM <KEY> <MEMBER>+`                                                                     | 删除集合中的若干个元素，返回删除的元素数量                                                                                                                                                 |
| `SPOP`             | 删   | `SPOP <KEY>`                                                                               | 随机删除集合中的一个元素，并返回该元素的值                                                                                                                                                 |
| `SCARD`            | 查   | `SCARD <KEY>`                                                                              | 返回集合中的元素个数。若`<KEY>`不存在则返回`0`                                                                                                                                          |
| `SISMEMBER`        | 查   | `SISMEMBER <KEY> <MEMBER>`                                                                 | 检测集合是否包含某个元素，返回布尔值`0`/`1`                                                                                                                                             |
| `SINTER`           | 集   | `SINTER <KEY>+`                                                                            | 返回若干个集合的交集，若`<KEY>`不存在则视为空集                                                                                                                                           |
| `SUNION`           | 集   | `SUNION <KEY>+`                                                                            | 返回若干个集合的并集，若`<KEY>`不存在则视为空集                                                                                                                                           |
| `SDIFF`            | 集   | `SDIFF <KEY>+`                                                                             | 返回第一个集合减后面若干个集合的差集，若`<KEY>`不存在则视为空集                                                                                                                                   |
| `ZADD`             | 增   | `ZADD <KEY> [<SCORE> <MEMBER>]+`                                                           | 将若干个元素`<MEMBER>+`添加到有序集合中，返回有序集合原先不存在的元素的数量                                                                                                                           |
| `ZRANGE`           | 查   | `ZRANGE <KEY> <START> <STOP> [WITHSCORES]`                                                 | 返回有序集合中位于闭区间`[<START>, <STOP>]`中的所有元素，支持负数索引，索引越界时不报错。使用`WITHSCORE`选项时会同时间隔返回所有`MEMBER`的`<SCORE>`，放在其前面                                                               |
| `ZREM`             | 删   | `ZREM <KEY> <MEMBER>+`                                                                     | 删除有序集合中的若干个元素，返回删除的元素数量                                                                                                                                               |
| `ZCARD`            | 查   | `ZCARD <KEY>`                                                                              | 返回有序集合中的元素个数                                                                                                                                                          |
| `ZCOUNT`           | 查   | `ZCOUNT <KEY> <MIN> <MAX>`                                                                 | 返回有序集合中`<SCORE>`位于闭区间`[<MIN>, <MAX>]`内的所有`<MEMBER>`的个数                                                                                                                |
| `ZSCORE`           | 查   | `ZSCORE <KEY> <MEMBER>`                                                                    | 返回有序集合中`<MEMBER>`对应的`<SCORE>`值，若`<KEY>`不存在或`<MEMBER>`不存在则返回`nil`                                                                                                      |
| `ZRANK`            | 查   | `ZRANK <KEY> <MEMBER>`                                                                     | 返回有序集合中`<MEMBER>`对于`<SCOER>`的升序排名，从`0`开始计数。若`<MEMBER>`不存在则返回`nil`                                                                                                     |
| `ZINCRBY`          | 改   | `ZINCRBY <KEY> <INCREMENT> <MEMBER>`                                                       | 为有序集合中`<MEMBER>`对应的`<SCORE>`添加增量`<INCREMENT>`                                                                                                                         |
| `ZREVRANK`         | 查   | `ZREVRANK <KEY> <MEMBER>`                                                                  | 返回有序集合中`<MEMBER>`对于`<SCOER>`的降序排名，从`0`开始计数。若`<MEMBER>`不存在则返回`nil`                                                                                                     |
| `ZUNIONSTORE`      | 集   | `ZUNIONSTORE <DESTINATION> <NUMKEYS> <KEY>+ [WEIGHTS <WEIGHT>+] [AGGREGATE SUM\|MIN\|MAX]` | 给定若干个有序集合`<KEY>+`，统计其中所有同名`<MEMBER>`的`<SCORE>`经过指定聚合函数（缺省为`SUM`）得到的结果作为新`<SCORE>`，存储到新的有序集合`<DESTINATION>`中。`<NUMKEYS>`表示输入有序集合的个数。使用`<WEIGHTS>`指定各个有序集合的权重系数         |
| `ZREMRANGEBYRANK`  | 删   | `ZREMRANGEBYRANK <KEY> <START> <STOP>`                                                     | 删除有序集合中排名位于闭区间`[<START>, <STOP>]`中的元素，排名从`0`计数，支持负数排名                                                                                                                 |
| `ZREVRANGEBYSCORE` | 查   | `ZREVRANGEBYSCORE <KEY> <MIN> <MAX> [WITHSCORES] [LIMIT <OFFSET> <COUNT>]`                 | 返回有序集合中`<SCORE>`位于闭区间`[<MIN>, <MAX>]`的所有`<MEMBER>`，按`<SCORE>`降序排列，若`<SCORE>`相同则按`<MEMBER>`字典序逆序排列                                                                     |
| `ZRANDMEMBER`      | 查   | `ZRANDMEMBER <KEY> [<COUNT> [<WITHSCORES>]]`                                               | 从有序集合中随机返回`min(abs(<COUNT>), ZCOUNT <KEY>`个元素，缺省值为`1`。若`<COUNT>`为负，则允许重复地挑选随机元素                                                                                       |
|                    |     |                                                                                            |                                                                                                                                                                       |

键值对的元数据：

| 命令          | 语法                                                                                                                               | 作用                                            |
| ----------- | -------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------- |
| `SCAN`      | `SCAN <CURSOR>`                                                                                                                  | 基于游标的查询，返回一个数组，其中`[0]`表示下一个游标，`[1]`表示得到的值     |
| `TTL`       | `TTL <KEY>`                                                                                                                      | 键值对的剩余生存时间，返回秒数，其中`-2`表示键不存在，`-1`表示没有设置剩余生存时间 |
| `EXPIRE`    | `EXPIRE <KEY> <SECONDS>`                                                                                                         | 设置键值对的剩余生存时间，返回`0`/`1`布尔值表示是否设置成功             |
| `SELECT`    | `SELECT <DATABASE>`                                                                                                              | 切换到数据库                                        |
| `MOVE`      | `MOVE <KEY> <DATABASE>`                                                                                                          | 将键值对从当前数据库移动到指定数据库                            |
| `FLUSHDB`   | `FLUSHDB`                                                                                                                        | 清除当前数据库的所有键值对                                 |
| `RANDOMKEY` | `RAMDOMKEY`                                                                                                                      | 从当前数据库随机返回一个键值对的键名。若数据库为空则返回`nil`             |
| `SORT`      | `SORT <KEY> [BY <PATTERN>] [LIMIT <OFFSET> <COUNT>] [GET <PATTERN>[GET <PATTERN>...]] [ASC\|DESC] [ALPHA] [STORE <DESTINATION>]` | 排序                                            |
